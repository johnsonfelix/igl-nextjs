generator client {
  provider      = "prisma-client-js"
  output        = "../node_modules/.prisma/client"
  binaryTargets = ["native", "rhel-openssl-1.0.x"]
}

datasource db {
  provider  = "postgresql"
  url       = env("POSTGRES_URL")
  directUrl = env("POSTGRES_URL_NON_POOLING")
}

model Company {
  id                    String            @id @default(cuid())
  memberId              String            @unique
  memberType            String?
  name                  String
  website               String?
  established           DateTime?
  size                  String?
  about                 String?
  memberSince           DateTime?
  userId                String?
  memberFromYear        Int?
  createdAt             DateTime          @default(now())
  updatedAt             DateTime          @updatedAt
  sector                String?
  logoUrl               String?
  purchasedMembership   String?
  isVerified            Boolean           @default(false)
  isActive              Boolean           @default(true)
  status                CompanyStatus     @default(LIVE)
  zipCode               String?
  membershipExpiresAt   DateTime?
  purchasedAt           DateTime?
  purchasedMembershipId String?
  membershipPlanId      String?
  directors             String?
  designation           String?
  participationYears    String?
  scopeOfBusiness       String?
  servicesOffered       String?
  membershipPlan        MembershipPlan?   @relation(fields: [membershipPlanId], references: [id])
  user                  User?             @relation("UserCompanies", fields: [userId], references: [id])
  inquiry               Inquiry[]         @relation("CompanyInquiry")
  inquiryResponses      InquiryResponse[] @relation("ResponderCompany")
  location              Location?
  sentMessages          Message[]         @relation("SentMessages")
  purchaseOrders        PurchaseOrder[]
  reports               Report[]
  activities            Activity[]        @relation("CompanyActivities")
  certificates          Certificate[]     @relation("CompanyCertificates")
  conversations         Conversation[]    @relation("CompanyConversations")
  media                 Media[]           @relation("CompanyMedia")
  partners              Partner[]         @relation("CompanyPartners")
  services              Service[]         @relation("CompanyServices")
  readMessages          Message[]         @relation("ReadMessages")
}

model Service {
  id        String    @id @default(cuid())
  type      String
  companies Company[] @relation("CompanyServices")
}

model Partner {
  id        String      @id @default(cuid())
  name      String
  type      PartnerType
  companies Company[]   @relation("CompanyPartners")
}

model Certificate {
  id          String    @id @default(cuid())
  title       String
  issuedBy    String?
  issuedDate  DateTime?
  description String?
  companies   Company[] @relation("CompanyCertificates")
}

model Media {
  id        String    @id @default(cuid())
  type      MediaType
  url       String
  altText   String?
  companies Company[] @relation("CompanyMedia")
}

model Activity {
  id          String    @id @default(cuid())
  eventDate   DateTime
  description String
  imageUrl    String?
  companies   Company[] @relation("CompanyActivities")
}

model Location {
  id                       String  @id @default(cuid())
  address                  String
  city                     String
  state                    String?
  country                  String
  zipCode                  String?
  phone                    String?
  fax                      String?
  email                    String?
  companyId                String  @unique
  contactPerson            String?
  mobile                   String?
  skype                    String?
  wechat                   String?
  contactPersonDesignation String?
  company                  Company @relation(fields: [companyId], references: [id], onDelete: Cascade)
}

model User {
  id               String    @id @default(cuid())
  email            String    @unique
  password         String
  name             String?
  role             Role      @default(USER)
  createdAt        DateTime  @default(now())
  updatedAt        DateTime  @updatedAt
  isCompleted      Boolean   @default(false)
  phone            String?
  resetToken       String?
  resetTokenExpiry DateTime?
  companies        Company[] @relation("UserCompanies")
}

model Event {
  id                String             @id @default(cuid())
  name              String
  location          String
  thumbnail         String
  expectedAudience  String
  createdAt         DateTime           @default(now())
  updatedAt         DateTime           @updatedAt
  endDate           DateTime?
  eventType         EventType?
  startDate         DateTime?
  description       String?
  agendaItems       AgendaItem[]
  earlyBird         Boolean            @default(false)
  boothSubTypes     BoothSubType[]
  eventBooths       EventBooth[]
  eventRoomTypes    EventRoomType[]    @relation("EventRoomTypes")
  eventSponsorTypes EventSponsorType[] @relation("EventSponsorTypes")
  eventTickets      EventTicket[]      @relation("EventTickets")
  purchaseOrders    PurchaseOrder[]
  venue             Venue?
  hotels            Hotel[]            @relation("EventHotels")
}

model SponsorType {
  id                String             @id @default(cuid())
  name              String             @unique
  image             String?
  price             Float
  createdAt         DateTime           @default(now())
  imageKey          String?
  updatedAt         DateTime           @updatedAt
  description       String?
  sortOrder         Int                @default(0)
  features          String[]           @default([])
  eventSponsorTypes EventSponsorType[] @relation("EventSponsorTypes")
  offers            Offer[]            @relation("OfferSponsorTypes")
}

model Ticket {
  id           String        @id @default(cuid())
  name         String
  logo         String
  price        Float
  description  String?
  sellingPrice Float?
  features     String[]      @default([])
  eventTickets EventTicket[] @relation("EventTickets")
  offers       Offer[]       @relation("OfferTickets")
}

model Hotel {
  id            String     @id @default(cuid())
  hotelName     String
  address       String?
  contact       String?
  image         String?
  contactPerson String?
  email         String?
  roomTypes     RoomType[]
  events        Event[]    @relation("EventHotels")
  offers        Offer[]    @relation("OfferHotels")
}

model RoomType {
  id             String          @id @default(cuid())
  hotelId        String
  roomType       String
  price          Float
  availableRooms Int
  maxOccupancy   Int
  amenities      String?
  image          String?
  eventRoomTypes EventRoomType[] @relation("EventRoomTypes")
  hotel          Hotel           @relation(fields: [hotelId], references: [id], onDelete: Cascade)
}

model Booth {
  id          String         @id @default(cuid())
  image       String
  price       Float
  description String?
  name        String
  subTypes    BoothSubType[]
  eventBooths EventBooth[]
  offers      Offer[]        @relation("OfferBooths")
}

model EventBooth {
  eventId  String
  boothId  String
  quantity Int    @default(1)
  booth    Booth  @relation(fields: [boothId], references: [id], onDelete: Cascade)
  event    Event  @relation(fields: [eventId], references: [id], onDelete: Cascade)

  @@id([eventId, boothId])
  @@index([boothId])
}

model AgendaItem {
  id          String   @id @default(cuid())
  date        DateTime
  title       String
  description String?
  eventId     String
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  startTime   DateTime
  endTime     DateTime
  event       Event    @relation(fields: [eventId], references: [id], onDelete: Cascade)
}

model Venue {
  id              String   @id @default(cuid())
  name            String
  description     String?
  imageUrls       String[]
  closestAirport  String?
  publicTransport String?
  nearbyPlaces    String?
  eventId         String   @unique
  location        String?
  event           Event    @relation(fields: [eventId], references: [id], onDelete: Cascade)
}

model Inquiry {
  id             String            @id @default(cuid())
  cargoType      String
  createdAt      DateTime          @default(now())
  cargoReadyTime DateTime?
  commodity      String
  companyId      String
  contactEmail   String?
  contactName    String?
  contactPhone   String?
  dimensions     String?
  freightTerm    String?
  from           String
  incoterms      String?
  remark         String?
  shipmentMode   shipmentMode
  to             String
  volume         Float?
  weight         Float?
  company        Company           @relation("CompanyInquiry", fields: [companyId], references: [id], onDelete: Cascade)
  responses      InquiryResponse[]
}

model InquiryResponse {
  id          String   @id @default(cuid())
  inquiryId   String
  responderId String
  message     String
  offerPrice  Float?
  attachment  String?
  createdAt   DateTime @default(now())
  inquiry     Inquiry  @relation(fields: [inquiryId], references: [id])
  responder   Company  @relation("ResponderCompany", fields: [responderId], references: [id], onDelete: Cascade)
}

model EventTicket {
  eventId  String
  ticketId String
  quantity Int    @default(1)
  event    Event  @relation("EventTickets", fields: [eventId], references: [id], onDelete: Cascade)
  ticket   Ticket @relation("EventTickets", fields: [ticketId], references: [id], onDelete: Cascade)

  @@id([eventId, ticketId])
}

model EventSponsorType {
  eventId       String
  sponsorTypeId String
  quantity      Int         @default(1)
  event         Event       @relation("EventSponsorTypes", fields: [eventId], references: [id], onDelete: Cascade)
  sponsorType   SponsorType @relation("EventSponsorTypes", fields: [sponsorTypeId], references: [id], onDelete: Cascade)

  @@id([eventId, sponsorTypeId])
}

model EventRoomType {
  eventId    String
  roomTypeId String
  quantity   Int      @default(1)
  event      Event    @relation("EventRoomTypes", fields: [eventId], references: [id], onDelete: Cascade)
  roomType   RoomType @relation("EventRoomTypes", fields: [roomTypeId], references: [id], onDelete: Cascade)

  @@id([eventId, roomTypeId])
}

model BoothSubType {
  id          String           @id @default(cuid())
  name        String
  price       Float
  description String?
  boothId     String
  eventId     String
  createdAt   DateTime         @default(now())
  updatedAt   DateTime         @updatedAt
  isAvailable Boolean          @default(true)
  slotEnd     DateTime?
  slotStart   DateTime?
  type        BoothSubTypeType @default(BOOTH_NUMBER)
  booth       Booth            @relation(fields: [boothId], references: [id], onDelete: Cascade)
  event       Event            @relation(fields: [eventId], references: [id], onDelete: Cascade)

  @@unique([boothId, eventId, name])
}

model PurchaseOrder {
  id                   String      @id @default(cuid())
  companyId            String
  eventId              String?
  totalAmount          Float
  status               OrderStatus @default(COMPLETED)
  createdAt            DateTime    @default(now())
  invoiceNumber        Int         @default(autoincrement())
  couponId             String?
  discountAmount       Float?
  billingAddressLine1  String?
  billingAddressLine2  String?
  billingCity          String?
  billingCountry       String?
  billingState         String?
  billingZip           String?
  shippingAddressLine1 String?
  shippingAddressLine2 String?
  shippingCity         String?
  shippingCountry      String?
  shippingState        String?
  shippingZip          String?
  offlinePayment       Boolean     @default(false)
  account              Json?
  additionalDetails    Json?
  paymentMethod        String?
  paymentProof         String?
  items                OrderItem[]
  company              Company     @relation(fields: [companyId], references: [id], onDelete: Cascade)
  coupon               Coupon?     @relation(fields: [couponId], references: [id])
  event                Event?      @relation(fields: [eventId], references: [id])

  @@index([companyId])
  @@index([eventId])
}

model OrderItem {
  id             String        @id @default(cuid())
  orderId        String
  productId      String
  productType    String
  name           String
  quantity       Int
  price          Float
  roomTypeId     String?
  boothSubTypeId String?
  createdAt      DateTime      @default(now())
  order          PurchaseOrder @relation(fields: [orderId], references: [id], onDelete: Cascade)

  @@index([orderId])
}

model Conversation {
  id              String    @id @default(cuid())
  createdAt       DateTime  @default(now())
  updatedAt       DateTime  @updatedAt
  lastMessageText String?
  lastMessageAt   DateTime?
  messages        Message[]
  participants    Company[] @relation("CompanyConversations")

  @@index([updatedAt])
}

model Message {
  id             String       @id @default(cuid())
  createdAt      DateTime     @default(now())
  content        String
  senderId       String
  conversationId String
  conversation   Conversation @relation(fields: [conversationId], references: [id], onDelete: Cascade)
  sender         Company      @relation("SentMessages", fields: [senderId], references: [id], onDelete: Cascade)
  readBy         Company[]    @relation("ReadMessages")

  @@index([conversationId])
  @@index([senderId])
}

model MembershipPlan {
  id                 String    @id @default(cuid())
  name               String    @unique
  slug               String?   @unique
  price              Float
  features           String[]
  createdAt          DateTime  @default(now())
  updatedAt          DateTime  @updatedAt
  description        String?
  thumbnail          String?
  paymentProtection  String?
  discountPercentage Float?
  companies          Company[]
  offers             Offer[]   @relation("OfferMembershipPlans")
}

model Coupon {
  id             String          @id @default(cuid())
  code           String          @unique
  discountType   DiscountType
  discountValue  Float
  createdAt      DateTime        @default(now())
  updatedAt      DateTime        @updatedAt
  purchaseOrders PurchaseOrder[]
}

model Offer {
  id              String           @id @default(cuid())
  name            String
  code            String?          @unique
  description     String?
  percentage      Float
  scope           OfferScope       @default(ALL)
  startsAt        DateTime?
  endsAt          DateTime?
  isActive        Boolean          @default(true)
  createdAt       DateTime         @default(now())
  updatedAt       DateTime         @updatedAt
  booths          Booth[]          @relation("OfferBooths")
  hotels          Hotel[]          @relation("OfferHotels")
  membershipPlans MembershipPlan[] @relation("OfferMembershipPlans")
  sponsorTypes    SponsorType[]    @relation("OfferSponsorTypes")
  tickets         Ticket[]         @relation("OfferTickets")
}

model Report {
  id                String       @id @default(cuid())
  reportedCompanyId String
  reason            String
  status            ReportStatus @default(PENDING)
  createdAt         DateTime     @default(now())
  updatedAt         DateTime     @updatedAt
  reportedCompany   Company      @relation(fields: [reportedCompanyId], references: [id], onDelete: Cascade)
}

enum CompanyStatus {
  LIVE
  BLOCKLISTED
  SUSPENDED
}

enum PartnerType {
  AIR
  SEA
  RAIL
  COURIER
}

enum MediaType {
  IMAGE
  VIDEO
  DOCUMENT
  LOGO
}

enum Role {
  USER
  ADMIN
  MODERATOR
}

enum EventType {
  Hot
  New
}

enum shipmentMode {
  AIR
  SEA
  LAND
}

enum BoothSubTypeType {
  BOOTH_NUMBER
  TIME_SLOT
  CUSTOM
}

enum OrderStatus {
  PENDING
  COMPLETED
  FAILED
  REFUNDED
}

enum DiscountType {
  FIXED
  PERCENTAGE
}

enum OfferScope {
  ALL
  HOTELS
  TICKETS
  SPONSORS
  CUSTOM
  BOOTHS
  SUBSCRIPTIONS
}

enum ReportStatus {
  PENDING
  REVIEWED
  RESOLVED
}

model Testimonial {
  id          String   @id @default(cuid())
  name        String
  role        String
  description String
  rating      Int      @default(5)
  image       String?
  isActive    Boolean  @default(true)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

model PastEvent {
  id              String   @id @default(cuid())
  title           String
  place           String
  date            String
  membersAttended Int
  description     String   @db.Text
  mainImage       String
  carouselImages  String[]
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt
}
